async function main() {
  exposeGameInternalObjects();
  globalThis.openDevMenu = openDevMenu;
}
function exposeWebpackRequire() {
  if (globalThis.webpackRequire) {
    return;
  }
  globalThis.webpackChunkbitburner.push([
    [-1],
    {},
    (webpackRequire2) => globalThis.webpackRequire = webpackRequire2
  ]);
}
function checkIfFunctionCodeIncludesSpecificString(object, specificString) {
  return !!object && typeof object === "function" && !Object.hasOwn(object, "toString") && String(object).includes(specificString);
}
function exposeGameInternalObjects(overrideUpdateRamUsed = false) {
  if (!globalThis.webpackChunkbitburner) {
    return;
  }
  exposeWebpackRequire();
  let SaveObjectModule = {};
  let AllServersModule = {};
  let FactionsModule = {};
  let CompaniesModule = {};
  let AllGangsModule = {};
  let StockMarketModule = {};
  for (const moduleId of Object.keys(webpackRequire.m)) {
    const module = webpackRequire(moduleId);
    if (!module) {
      continue;
    }
    const exportedValues = Object.values(module);
    for (const value of exportedValues) {
      if (!value) {
        continue;
      }
      if (value.Base && value.Dom) {
        globalThis.RamCostConstants = value;
      }
      if (overrideUpdateRamUsed && value.fromJSONBase && value.toString().includes("v2.3FileChanges")) {
        value.prototype.updateRamUsed = () => {
        };
      }
      if (value.bitNodeN) {
        globalThis.Player = value;
      }
      if (value.load && value.start && value.updateGame) {
        globalThis.Engine = value;
      }
      if (value.importGame) {
        SaveObjectModule = module;
      }
      if (checkIfFunctionCodeIncludesSpecificString(value, "Error: Trying to add a server with an existing IP")) {
        AllServersModule = module;
      }
      if (checkIfFunctionCodeIncludesSpecificString(value, "Invalid faction in player save factions array")) {
        FactionsModule = module;
      }
      if (checkIfFunctionCodeIncludesSpecificString(value, "CompanyName") && checkIfFunctionCodeIncludesSpecificString(value, "playerReputation") && exportedValues.length === 3) {
        CompaniesModule = module;
      }
      if (checkIfFunctionCodeIncludesSpecificString(value, "Cannot load data of AllGangs")) {
        AllGangsModule = module;
      }
      if (checkIfFunctionCodeIncludesSpecificString(value, "Cannot load data of StockMarket")) {
        StockMarketModule = module;
      }
      if (checkIfFunctionCodeIncludesSpecificString(value, "Could not locate constructor named")) {
        globalThis.Reviver = value;
      }
      if (value.AutosaveInterval) {
        globalThis.Settings = value;
      }
      if (checkIfFunctionCodeIncludesSpecificString(value, "Invalid AI move attempted")) {
        globalThis.GoAI = module;
      }
    }
  }
  if (!globalThis.Player) {
    console.error("Cannot expose Player");
  }
  if (!globalThis.Engine) {
    console.error("Cannot expose Engine");
  }
  globalThis.SaveObject = {};
  for (const value of Object.values(SaveObjectModule)) {
    if (value.importGame) {
      globalThis.SaveObject.saveObject = value;
    }
    if (checkIfFunctionCodeIncludesSpecificString(value, "Could not load Aliases from save")) {
      globalThis.SaveObject.loadGame = value;
    }
  }
  if (!globalThis.SaveObject.saveObject) {
    console.error("Cannot expose SaveObjectModule");
  }
  globalThis.AllServers = {};
  for (const value of Object.values(AllServersModule)) {
    if (checkIfFunctionCodeIncludesSpecificString(value, "Object.hasOwn")) {
      globalThis.AllServers.GetServer = value;
    }
    if (checkIfFunctionCodeIncludesSpecificString(value, "Object.keys") && checkIfFunctionCodeIncludesSpecificString(value, ".push")) {
      globalThis.AllServers.GetAllServers = value;
    }
    if (checkIfFunctionCodeIncludesSpecificString(value, "JSON.parse")) {
      globalThis.AllServers.loadAllServers = value;
    }
    if (checkIfFunctionCodeIncludesSpecificString(value, "JSON.stringify")) {
      globalThis.AllServers.saveAllServers = value;
    }
  }
  if (!globalThis.AllServers.GetServer) {
    console.error("Cannot expose AllServersModule");
  }
  for (const value of Object.values(FactionsModule)) {
    if (typeof value === "object") {
      globalThis.Factions = value;
      break;
    }
  }
  if (!globalThis.Factions) {
    console.error("Cannot expose Factions");
  }
  for (const value of Object.values(CompaniesModule)) {
    if (typeof value === "object") {
      globalThis.Companies = value;
      break;
    }
  }
  if (!globalThis.Companies) {
    console.error("Cannot expose Companies");
  }
  for (const value of Object.values(AllGangsModule)) {
    if (typeof value === "object") {
      globalThis.AllGangs = value;
      break;
    }
  }
  if (!globalThis.AllGangs) {
    console.error("Cannot expose AllGangs");
  }
  for (const value of Object.values(StockMarketModule)) {
    if (value.Orders) {
      globalThis.StockMarket = value;
      break;
    }
  }
  if (!globalThis.StockMarket) {
    console.error("Cannot expose StockMarket");
  }
  if (!globalThis.Reviver) {
    console.error("Cannot expose Reviver");
  }
  if (!globalThis.Settings) {
    console.error("Cannot expose Settings");
  }
  if (!globalThis.GoAI) {
    console.error("Cannot expose GoAI");
  }
}
function openDevMenu() {
  if (!globalThis.webpackChunkbitburner) {
    return;
  }
  exposeWebpackRequire();
  for (const moduleId of Object.keys(webpackRequire.m)) {
    const module = webpackRequire(moduleId);
    for (const value of Object.values(module)) {
      if (value && value.toPage) {
        value.toPage("Dev");
        return;
      }
    }
  }
}
function disableRAMCost() {
  exposeGameInternalObjects(true);
  RamCostConstants.Max = RamCostConstants.Base = Number.MIN_VALUE;
  if (!globalThis.MathRound) {
    globalThis.MathRound = Math.round;
    Math.round = (value) => {
      if (value === RamCostConstants.Max * 100) {
        return value;
      }
      return globalThis.MathRound(value);
    };
  }
  for (const server of AllServers.GetAllServers()) {
    server.ramUsed = 0;
  }
}
export {
  exposeGameInternalObjects,
  main
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vc3JjL2V4cGxvaXRzLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyIvKiBlc2xpbnQtZGlzYWJsZSBuby12YXIgKi9cbi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkgKi9cblxuZXhwb3J0IHR5cGUgU2F2ZURhdGEgPSBzdHJpbmcgfCBVaW50OEFycmF5O1xuXG5kZWNsYXJlIGdsb2JhbCB7XG4gICAgdmFyIHdlYnBhY2tSZXF1aXJlOiBhbnk7XG4gICAgdmFyIHdlYnBhY2tDaHVua2JpdGJ1cm5lcjogYW55O1xuICAgIC8vIHZhciBQbGF5ZXI6IGFueTtcbiAgICB2YXIgRW5naW5lOiB7XG4gICAgICAgIHVwZGF0ZUdhbWU6IChudW1DeWNsZXM/OiBudW1iZXIpID0+IHZvaWQ7XG4gICAgICAgIGxvYWQ6IChzYXZlRGF0YTogU2F2ZURhdGEpID0+IFByb21pc2U8dm9pZD47XG4gICAgICAgIHN0YXJ0OiAoKSA9PiB2b2lkO1xuICAgIH07XG4gICAgdmFyIFNhdmVPYmplY3Q6IHtcbiAgICAgICAgc2F2ZU9iamVjdDoge1xuICAgICAgICAgICAgZ2V0U2F2ZURhdGE6IChmb3JjZUV4Y2x1ZGVSdW5uaW5nU2NyaXB0czogYm9vbGVhbiwgZm9yY2VFeGNsdWRlU2NyaXB0czogYm9vbGVhbikgPT4gUHJvbWlzZTxTYXZlRGF0YT47XG4gICAgICAgIH07XG4gICAgICAgIGxvYWRHYW1lOiAoc2F2ZURhdGE6IFNhdmVEYXRhKSA9PiBQcm9taXNlPGJvb2xlYW4+O1xuICAgIH07XG4gICAgdmFyIEFsbFNlcnZlcnM6IHtcbiAgICAgICAgR2V0U2VydmVyOiAoKSA9PiBhbnk7XG4gICAgICAgIEdldEFsbFNlcnZlcnM6ICgpID0+IGFueVtdO1xuICAgICAgICBsb2FkQWxsU2VydmVyczogKHNhdmVTdHJpbmc6IHN0cmluZykgPT4gdm9pZDtcbiAgICAgICAgc2F2ZUFsbFNlcnZlcnM6ICgpID0+IHN0cmluZztcbiAgICB9O1xuICAgIHZhciBGYWN0aW9uczogYW55O1xuICAgIHZhciBDb21wYW5pZXM6IGFueTtcbiAgICB2YXIgQWxsR2FuZ3M6IGFueTtcbiAgICB2YXIgU3RvY2tNYXJrZXQ6IGFueTtcbiAgICB2YXIgUmV2aXZlcjogYW55O1xuICAgIHZhciBTZXR0aW5nczogYW55O1xuICAgIHZhciBHb0FJOiBhbnk7XG4gICAgdmFyIG9wZW5EZXZNZW51OiBhbnk7XG4gICAgdmFyIFJhbUNvc3RDb25zdGFudHM6IGFueTtcbiAgICB2YXIgTWF0aFJvdW5kOiBhbnk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBtYWluKCkge1xuICAgIGV4cG9zZUdhbWVJbnRlcm5hbE9iamVjdHMoKTtcbiAgICBnbG9iYWxUaGlzLm9wZW5EZXZNZW51ID0gb3BlbkRldk1lbnU7XG4gICAgLy8gZGlzYWJsZVJBTUNvc3QoKTtcbn1cblxuZnVuY3Rpb24gZXhwb3NlV2VicGFja1JlcXVpcmUoKSB7XG4gICAgaWYgKGdsb2JhbFRoaXMud2VicGFja1JlcXVpcmUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBnbG9iYWxUaGlzLndlYnBhY2tDaHVua2JpdGJ1cm5lci5wdXNoKFtcbiAgICAgICAgWy0xXSxcbiAgICAgICAge30sXG4gICAgICAgICh3ZWJwYWNrUmVxdWlyZTogYW55KSA9PiAoZ2xvYmFsVGhpcy53ZWJwYWNrUmVxdWlyZSA9IHdlYnBhY2tSZXF1aXJlKSxcbiAgICBdKTtcbn1cblxuZnVuY3Rpb24gY2hlY2tJZkZ1bmN0aW9uQ29kZUluY2x1ZGVzU3BlY2lmaWNTdHJpbmcob2JqZWN0OiB1bmtub3duLCBzcGVjaWZpY1N0cmluZzogc3RyaW5nKSB7XG4gICAgcmV0dXJuIChcbiAgICAgICAgISFvYmplY3QgJiZcbiAgICAgICAgdHlwZW9mIG9iamVjdCA9PT0gXCJmdW5jdGlvblwiICYmXG4gICAgICAgICFPYmplY3QuaGFzT3duKG9iamVjdCwgXCJ0b1N0cmluZ1wiKSAmJlxuICAgICAgICBTdHJpbmcob2JqZWN0KS5pbmNsdWRlcyhzcGVjaWZpY1N0cmluZylcbiAgICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZXhwb3NlR2FtZUludGVybmFsT2JqZWN0cyhvdmVycmlkZVVwZGF0ZVJhbVVzZWQgPSBmYWxzZSkge1xuICAgIGlmICghZ2xvYmFsVGhpcy53ZWJwYWNrQ2h1bmtiaXRidXJuZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBleHBvc2VXZWJwYWNrUmVxdWlyZSgpO1xuICAgIGxldCBTYXZlT2JqZWN0TW9kdWxlID0ge307XG4gICAgbGV0IEFsbFNlcnZlcnNNb2R1bGUgPSB7fTtcbiAgICBsZXQgRmFjdGlvbnNNb2R1bGUgPSB7fTtcbiAgICBsZXQgQ29tcGFuaWVzTW9kdWxlID0ge307XG4gICAgbGV0IEFsbEdhbmdzTW9kdWxlID0ge307XG4gICAgbGV0IFN0b2NrTWFya2V0TW9kdWxlID0ge307XG4gICAgZm9yIChjb25zdCBtb2R1bGVJZCBvZiBPYmplY3Qua2V5cyh3ZWJwYWNrUmVxdWlyZS5tKSkge1xuICAgICAgICBjb25zdCBtb2R1bGUgPSB3ZWJwYWNrUmVxdWlyZShtb2R1bGVJZCk7XG4gICAgICAgIGlmICghbW9kdWxlKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBleHBvcnRlZFZhbHVlczogYW55ID0gT2JqZWN0LnZhbHVlcyhtb2R1bGUpO1xuICAgICAgICBmb3IgKGNvbnN0IHZhbHVlIG9mIGV4cG9ydGVkVmFsdWVzKSB7XG4gICAgICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodmFsdWUuQmFzZSAmJiB2YWx1ZS5Eb20pIHtcbiAgICAgICAgICAgICAgICBnbG9iYWxUaGlzLlJhbUNvc3RDb25zdGFudHMgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChvdmVycmlkZVVwZGF0ZVJhbVVzZWQgJiYgdmFsdWUuZnJvbUpTT05CYXNlICYmIHZhbHVlLnRvU3RyaW5nKCkuaW5jbHVkZXMoXCJ2Mi4zRmlsZUNoYW5nZXNcIikpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZS5wcm90b3R5cGUudXBkYXRlUmFtVXNlZCA9ICgpID0+IHt9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZhbHVlLmJpdE5vZGVOKSB7XG4gICAgICAgICAgICAgICAgZ2xvYmFsVGhpcy5QbGF5ZXIgPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh2YWx1ZS5sb2FkICYmIHZhbHVlLnN0YXJ0ICYmIHZhbHVlLnVwZGF0ZUdhbWUpIHtcbiAgICAgICAgICAgICAgICBnbG9iYWxUaGlzLkVuZ2luZSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZhbHVlLmltcG9ydEdhbWUpIHtcbiAgICAgICAgICAgICAgICBTYXZlT2JqZWN0TW9kdWxlID0gbW9kdWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNoZWNrSWZGdW5jdGlvbkNvZGVJbmNsdWRlc1NwZWNpZmljU3RyaW5nKHZhbHVlLCBcIkVycm9yOiBUcnlpbmcgdG8gYWRkIGEgc2VydmVyIHdpdGggYW4gZXhpc3RpbmcgSVBcIikpIHtcbiAgICAgICAgICAgICAgICBBbGxTZXJ2ZXJzTW9kdWxlID0gbW9kdWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNoZWNrSWZGdW5jdGlvbkNvZGVJbmNsdWRlc1NwZWNpZmljU3RyaW5nKHZhbHVlLCBcIkludmFsaWQgZmFjdGlvbiBpbiBwbGF5ZXIgc2F2ZSBmYWN0aW9ucyBhcnJheVwiKSkge1xuICAgICAgICAgICAgICAgIEZhY3Rpb25zTW9kdWxlID0gbW9kdWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgIGNoZWNrSWZGdW5jdGlvbkNvZGVJbmNsdWRlc1NwZWNpZmljU3RyaW5nKHZhbHVlLCBcIkNvbXBhbnlOYW1lXCIpICYmXG4gICAgICAgICAgICAgICAgY2hlY2tJZkZ1bmN0aW9uQ29kZUluY2x1ZGVzU3BlY2lmaWNTdHJpbmcodmFsdWUsIFwicGxheWVyUmVwdXRhdGlvblwiKSAmJlxuICAgICAgICAgICAgICAgIGV4cG9ydGVkVmFsdWVzLmxlbmd0aCA9PT0gM1xuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgQ29tcGFuaWVzTW9kdWxlID0gbW9kdWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNoZWNrSWZGdW5jdGlvbkNvZGVJbmNsdWRlc1NwZWNpZmljU3RyaW5nKHZhbHVlLCBcIkNhbm5vdCBsb2FkIGRhdGEgb2YgQWxsR2FuZ3NcIikpIHtcbiAgICAgICAgICAgICAgICBBbGxHYW5nc01vZHVsZSA9IG1vZHVsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjaGVja0lmRnVuY3Rpb25Db2RlSW5jbHVkZXNTcGVjaWZpY1N0cmluZyh2YWx1ZSwgXCJDYW5ub3QgbG9hZCBkYXRhIG9mIFN0b2NrTWFya2V0XCIpKSB7XG4gICAgICAgICAgICAgICAgU3RvY2tNYXJrZXRNb2R1bGUgPSBtb2R1bGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY2hlY2tJZkZ1bmN0aW9uQ29kZUluY2x1ZGVzU3BlY2lmaWNTdHJpbmcodmFsdWUsIFwiQ291bGQgbm90IGxvY2F0ZSBjb25zdHJ1Y3RvciBuYW1lZFwiKSkge1xuICAgICAgICAgICAgICAgIGdsb2JhbFRoaXMuUmV2aXZlciA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZhbHVlLkF1dG9zYXZlSW50ZXJ2YWwpIHtcbiAgICAgICAgICAgICAgICBnbG9iYWxUaGlzLlNldHRpbmdzID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY2hlY2tJZkZ1bmN0aW9uQ29kZUluY2x1ZGVzU3BlY2lmaWNTdHJpbmcodmFsdWUsIFwiSW52YWxpZCBBSSBtb3ZlIGF0dGVtcHRlZFwiKSkge1xuICAgICAgICAgICAgICAgIGdsb2JhbFRoaXMuR29BSSA9IG1vZHVsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmICghZ2xvYmFsVGhpcy5QbGF5ZXIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkNhbm5vdCBleHBvc2UgUGxheWVyXCIpO1xuICAgIH1cbiAgICBpZiAoIWdsb2JhbFRoaXMuRW5naW5lKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJDYW5ub3QgZXhwb3NlIEVuZ2luZVwiKTtcbiAgICB9XG5cbiAgICBnbG9iYWxUaGlzLlNhdmVPYmplY3QgPSB7fSBhcyBhbnk7XG4gICAgZm9yIChjb25zdCB2YWx1ZSBvZiBPYmplY3QudmFsdWVzKFNhdmVPYmplY3RNb2R1bGUpIGFzIGFueSkge1xuICAgICAgICBpZiAodmFsdWUuaW1wb3J0R2FtZSkge1xuICAgICAgICAgICAgZ2xvYmFsVGhpcy5TYXZlT2JqZWN0LnNhdmVPYmplY3QgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2hlY2tJZkZ1bmN0aW9uQ29kZUluY2x1ZGVzU3BlY2lmaWNTdHJpbmcodmFsdWUsIFwiQ291bGQgbm90IGxvYWQgQWxpYXNlcyBmcm9tIHNhdmVcIikpIHtcbiAgICAgICAgICAgIGdsb2JhbFRoaXMuU2F2ZU9iamVjdC5sb2FkR2FtZSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICghZ2xvYmFsVGhpcy5TYXZlT2JqZWN0LnNhdmVPYmplY3QpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkNhbm5vdCBleHBvc2UgU2F2ZU9iamVjdE1vZHVsZVwiKTtcbiAgICB9XG5cbiAgICBnbG9iYWxUaGlzLkFsbFNlcnZlcnMgPSB7fSBhcyBhbnk7XG4gICAgZm9yIChjb25zdCB2YWx1ZSBvZiBPYmplY3QudmFsdWVzKEFsbFNlcnZlcnNNb2R1bGUpIGFzIGFueSkge1xuICAgICAgICBpZiAoY2hlY2tJZkZ1bmN0aW9uQ29kZUluY2x1ZGVzU3BlY2lmaWNTdHJpbmcodmFsdWUsIFwiT2JqZWN0Lmhhc093blwiKSkge1xuICAgICAgICAgICAgZ2xvYmFsVGhpcy5BbGxTZXJ2ZXJzLkdldFNlcnZlciA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIGNoZWNrSWZGdW5jdGlvbkNvZGVJbmNsdWRlc1NwZWNpZmljU3RyaW5nKHZhbHVlLCBcIk9iamVjdC5rZXlzXCIpICYmXG4gICAgICAgICAgICBjaGVja0lmRnVuY3Rpb25Db2RlSW5jbHVkZXNTcGVjaWZpY1N0cmluZyh2YWx1ZSwgXCIucHVzaFwiKVxuICAgICAgICApIHtcbiAgICAgICAgICAgIGdsb2JhbFRoaXMuQWxsU2VydmVycy5HZXRBbGxTZXJ2ZXJzID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNoZWNrSWZGdW5jdGlvbkNvZGVJbmNsdWRlc1NwZWNpZmljU3RyaW5nKHZhbHVlLCBcIkpTT04ucGFyc2VcIikpIHtcbiAgICAgICAgICAgIGdsb2JhbFRoaXMuQWxsU2VydmVycy5sb2FkQWxsU2VydmVycyA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjaGVja0lmRnVuY3Rpb25Db2RlSW5jbHVkZXNTcGVjaWZpY1N0cmluZyh2YWx1ZSwgXCJKU09OLnN0cmluZ2lmeVwiKSkge1xuICAgICAgICAgICAgZ2xvYmFsVGhpcy5BbGxTZXJ2ZXJzLnNhdmVBbGxTZXJ2ZXJzID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFnbG9iYWxUaGlzLkFsbFNlcnZlcnMuR2V0U2VydmVyKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJDYW5ub3QgZXhwb3NlIEFsbFNlcnZlcnNNb2R1bGVcIik7XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCB2YWx1ZSBvZiBPYmplY3QudmFsdWVzKEZhY3Rpb25zTW9kdWxlKSkge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICBnbG9iYWxUaGlzLkZhY3Rpb25zID0gdmFsdWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoIWdsb2JhbFRoaXMuRmFjdGlvbnMpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkNhbm5vdCBleHBvc2UgRmFjdGlvbnNcIik7XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCB2YWx1ZSBvZiBPYmplY3QudmFsdWVzKENvbXBhbmllc01vZHVsZSkpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgZ2xvYmFsVGhpcy5Db21wYW5pZXMgPSB2YWx1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICghZ2xvYmFsVGhpcy5Db21wYW5pZXMpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkNhbm5vdCBleHBvc2UgQ29tcGFuaWVzXCIpO1xuICAgIH1cblxuICAgIGZvciAoY29uc3QgdmFsdWUgb2YgT2JqZWN0LnZhbHVlcyhBbGxHYW5nc01vZHVsZSkpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgZ2xvYmFsVGhpcy5BbGxHYW5ncyA9IHZhbHVlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFnbG9iYWxUaGlzLkFsbEdhbmdzKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJDYW5ub3QgZXhwb3NlIEFsbEdhbmdzXCIpO1xuICAgIH1cblxuICAgIGZvciAoY29uc3QgdmFsdWUgb2YgT2JqZWN0LnZhbHVlcyhTdG9ja01hcmtldE1vZHVsZSkgYXMgYW55KSB7XG4gICAgICAgIGlmICh2YWx1ZS5PcmRlcnMpIHtcbiAgICAgICAgICAgIGdsb2JhbFRoaXMuU3RvY2tNYXJrZXQgPSB2YWx1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICghZ2xvYmFsVGhpcy5TdG9ja01hcmtldCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiQ2Fubm90IGV4cG9zZSBTdG9ja01hcmtldFwiKTtcbiAgICB9XG5cbiAgICBpZiAoIWdsb2JhbFRoaXMuUmV2aXZlcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiQ2Fubm90IGV4cG9zZSBSZXZpdmVyXCIpO1xuICAgIH1cblxuICAgIGlmICghZ2xvYmFsVGhpcy5TZXR0aW5ncykge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiQ2Fubm90IGV4cG9zZSBTZXR0aW5nc1wiKTtcbiAgICB9XG5cbiAgICBpZiAoIWdsb2JhbFRoaXMuR29BSSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiQ2Fubm90IGV4cG9zZSBHb0FJXCIpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gb3BlbkRldk1lbnUoKSB7XG4gICAgaWYgKCFnbG9iYWxUaGlzLndlYnBhY2tDaHVua2JpdGJ1cm5lcikge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGV4cG9zZVdlYnBhY2tSZXF1aXJlKCk7XG4gICAgZm9yIChjb25zdCBtb2R1bGVJZCBvZiBPYmplY3Qua2V5cyh3ZWJwYWNrUmVxdWlyZS5tKSkge1xuICAgICAgICBjb25zdCBtb2R1bGUgPSB3ZWJwYWNrUmVxdWlyZShtb2R1bGVJZCk7XG4gICAgICAgIGZvciAoY29uc3QgdmFsdWUgb2YgT2JqZWN0LnZhbHVlcyhtb2R1bGUpIGFzIGFueSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlICYmIHZhbHVlLnRvUGFnZSkge1xuICAgICAgICAgICAgICAgIHZhbHVlLnRvUGFnZShcIkRldlwiKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRpc2FibGVSQU1Db3N0KCkge1xuICAgIGV4cG9zZUdhbWVJbnRlcm5hbE9iamVjdHModHJ1ZSk7XG4gICAgUmFtQ29zdENvbnN0YW50cy5NYXggPSBSYW1Db3N0Q29uc3RhbnRzLkJhc2UgPSBOdW1iZXIuTUlOX1ZBTFVFO1xuICAgIGlmICghZ2xvYmFsVGhpcy5NYXRoUm91bmQpIHtcbiAgICAgICAgZ2xvYmFsVGhpcy5NYXRoUm91bmQgPSBNYXRoLnJvdW5kO1xuICAgICAgICBNYXRoLnJvdW5kID0gKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICBpZiAodmFsdWUgPT09IFJhbUNvc3RDb25zdGFudHMuTWF4ICogMTAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGdsb2JhbFRoaXMuTWF0aFJvdW5kKHZhbHVlKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBzZXJ2ZXIgb2YgQWxsU2VydmVycy5HZXRBbGxTZXJ2ZXJzKCkpIHtcbiAgICAgICAgc2VydmVyLnJhbVVzZWQgPSAwO1xuICAgIH1cbn1cbiJdLAogICJtYXBwaW5ncyI6ICJBQXNDQSxlQUFzQixPQUFPO0FBQ3pCLDRCQUEwQjtBQUMxQixhQUFXLGNBQWM7QUFFN0I7QUFFQSxTQUFTLHVCQUF1QjtBQUM1QixNQUFJLFdBQVcsZ0JBQWdCO0FBQzNCO0FBQUEsRUFDSjtBQUNBLGFBQVcsc0JBQXNCLEtBQUs7QUFBQSxJQUNsQyxDQUFDLEVBQUU7QUFBQSxJQUNILENBQUM7QUFBQSxJQUNELENBQUNBLG9CQUF5QixXQUFXLGlCQUFpQkE7QUFBQSxFQUMxRCxDQUFDO0FBQ0w7QUFFQSxTQUFTLDBDQUEwQyxRQUFpQixnQkFBd0I7QUFDeEYsU0FDSSxDQUFDLENBQUMsVUFDRixPQUFPLFdBQVcsY0FDbEIsQ0FBQyxPQUFPLE9BQU8sUUFBUSxVQUFVLEtBQ2pDLE9BQU8sTUFBTSxFQUFFLFNBQVMsY0FBYztBQUU5QztBQUVPLFNBQVMsMEJBQTBCLHdCQUF3QixPQUFPO0FBQ3JF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
